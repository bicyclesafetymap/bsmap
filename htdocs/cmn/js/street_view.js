function adjustPanoramaPov(){var a,e,t,r,n;a=panorama.getPosition(),e=latlng,t=e.lat()-a.lat(),r=e.lng()-a.lng(),n=Math.atan2(r,t)/Math.PI*180,setTimeout(function(){})}$("#stvMap").css("height",screenH-55+"px");var parameters,pitch=0,heading=parseInt(180*Math.random());if(""!==BaseURL){for(var base_url_array=BaseURL.split("/"),i=0;i<base_url_array.length;i++)base_url_array[i].match(/^@/)&&(parameters=base_url_array[i].split(","));if("undefined"!=typeof parameters)for(var j=0;j<parameters.length;j++)parameters[j].match(/^@[0-9]{2}./)&&(BaseLat=parseFloat(parameters[j].replace(/@/,""))),parameters[j].match(/^[0-9]{3}.[0-9]+$/)&&(BaseLong=parseFloat(parameters[j])),parameters[j].match(/[0-9]+h$/)&&(heading=parseFloat(parameters[j])),parameters[j].match(/^[0-9]+t$/)&&(pitch=parseFloat(parameters[j])-90)}var latlng=new google.maps.LatLng(BaseLat,BaseLong),map=new google.maps.Map(document.getElementById("stvMap"),{zoom:16,center:latlng,mapTypeId:google.maps.MapTypeId.ROADMAP}),panorama=new google.maps.StreetViewPanorama(document.getElementById("stvMap"),{position:latlng,pov:{heading:heading,pitch:pitch}});map.setStreetView(panorama);var streetViewDidAppearListener=google.maps.event.addListener(panorama,"status_changed",function(){if(google.maps.event.removeListener(streetViewDidAppearListener),!panorama.getPosition().equals(latlng))return void adjustPanoramaPov();var a=new google.maps.LatLng(latlng.lat(),latlng.lng()+4e-6);setTimeout(function(){panorama.setPosition(a)}),document.getElementById("stvMap").style.visibility="hidden";var e=google.maps.event.addListener(panorama,"status_changed",function(){google.maps.event.removeListener(e),panorama.getPosition().equals(a)||(document.getElementById("stvMap").style.visibility="show",adjustPanoramaPov())})});